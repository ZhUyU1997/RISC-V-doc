<table border="0" height="1453" width="1123">
<tr><td>
<div style="position:absolute; top:0; left:0;"><img height="1453" width="1123"src="bgimg/bg00041.jpg"/></div>
<div style="position:absolute;top:74.119;left:132.145;"><nobr>
<span style="font-size:20.022;font-style:italic;">Volume II: RISC-V Privileged Architectures V20190608-Priv-MSU-Ratified</span>
</nobr></div>
<div style="position:absolute;top:130.572;left:132.145;"><nobr>
<span style="font-size:20.022;">in any mode and regardless of current mode will transfer control to M-mode.</span>
</nobr></div>
<div style="position:absolute;top:74.119;left:971.067;"><nobr>
<span style="font-size:20.022;">29</span>
</nobr></div>
<div style="position:absolute;top:174.422;left:323.908;"><nobr>
<span style="font-size:14.628;">MXLEN-1</span>
</nobr></div>
<div style="position:absolute;top:174.422;left:786.165;"><nobr>
<span style="font-size:14.628;">0</span>
</nobr></div>
<div style="position:absolute;top:193.997;left:433.027;"><nobr>
<span style="font-size:16.456;">Synchronous Exceptions (</span>
<span style="font-size:16.456;font-weight:bold;">WARL</span>
<span style="font-size:16.456;">)</span>
</nobr></div>
<div style="position:absolute;top:214.843;left:524.659;"><nobr>
<span style="font-size:16.456;">MXLEN</span>
</nobr></div>
<div style="position:absolute;top:261.147;left:294.185;"><nobr>
<span style="font-size:20.022;">Figure 3.9: Machine Exception Delegation Register medeleg .</span>
</nobr></div>
<div style="position:absolute;top:310.366;left:132.145;"><nobr>
<span style="font-size:20.022;">medeleg has a bit position allocated for every synchronous exception shown in Table</span>
<span style="font-size:20.022;color: #000080;"><a href="#" onClick="javascript:parent.GotoNewPage(48); return false">3.6</a></span>
<span style="font-size:20.022;">on page</span>
<span style="font-size:20.022;color: #000080;"><a href="#" onClick="javascript:parent.GotoNewPage(48); return false">37</a></span>
<span style="font-size:20.022;">,</span>
</nobr></div>
<div style="position:absolute;top:333.571;left:132.145;"><nobr>
<span style="font-size:20.022;">with the index of the bit position equal to the value returned in the mcause register (i.e., setting</span>
</nobr></div>
<div style="position:absolute;top:358.439;left:132.145;"><nobr>
<span style="font-size:20.022;">bit 8 allows user-mode environment calls to be delegated to a lower-privilege trap handler).</span>
</nobr></div>
<div style="position:absolute;top:403.402;left:323.908;"><nobr>
<span style="font-size:14.628;">MXLEN-1</span>
</nobr></div>
<div style="position:absolute;top:403.402;left:786.165;"><nobr>
<span style="font-size:14.628;">0</span>
</nobr></div>
<div style="position:absolute;top:422.977;left:485.557;"><nobr>
<span style="font-size:16.456;">Interrupts (</span>
<span style="font-size:16.456;font-weight:bold;">WARL</span>
<span style="font-size:16.456;">)</span>
</nobr></div>
<div style="position:absolute;top:443.821;left:524.659;"><nobr>
<span style="font-size:16.456;">MXLEN</span>
</nobr></div>
<div style="position:absolute;top:490.125;left:292.878;"><nobr>
<span style="font-size:20.022;">Figure 3.10: Machine Interrupt Delegation Register mideleg .</span>
</nobr></div>
<div style="position:absolute;top:538.234;left:132.145;"><nobr>
<span style="font-size:20.022;">mideleg holds trap delegation bits for individual interrupts, with the layout of bits matching those</span>
</nobr></div>
<div style="position:absolute;top:561.439;left:132.145;"><nobr>
<span style="font-size:20.022;">in the mip register (i.e., STIP interrupt delegation control is located in bit 5).</span>
</nobr></div>
<div style="position:absolute;top:604.592;left:132.145;"><nobr>
<span style="font-size:20.022;">Some exceptions cannot occur at less privileged modes, and corresponding</span>
<span style="font-size:20.022;font-style:italic;">x</span>
<span style="font-size:20.022;">edeleg bits should be</span>
</nobr></div>
<div style="position:absolute;top:629.459;left:132.145;"><nobr>
<span style="font-size:20.022;">hardwired to zero. In particular, medeleg [11] and sedeleg [11:9] are all hardwired to zero.</span>
</nobr></div>
<div style="position:absolute;top:700.480;left:132.145;"><nobr>
<span style="font-size:21.942;font-weight:bold;">3.1.9</span>
</nobr></div>
<div style="position:absolute;top:700.480;left:207.516;"><nobr>
<span style="font-size:21.942;font-weight:bold;">Machine Interrupt Registers (</span>
<span style="font-size:21.942;">mip</span>
<span style="font-size:21.942;font-weight:bold;">and</span>
<span style="font-size:21.942;">mie</span>
<span style="font-size:21.942;font-weight:bold;">)</span>
</nobr></div>
<div style="position:absolute;top:757.987;left:132.145;"><nobr>
<span style="font-size:20.022;">The mip register is an MXLEN-bit read/write register containing information on pending interrupts,</span>
</nobr></div>
<div style="position:absolute;top:782.854;left:132.145;"><nobr>
<span style="font-size:20.022;">while mie is the corresponding MXLEN-bit read/write register containing interrupt enable bits.</span>
</nobr></div>
<div style="position:absolute;top:807.721;left:132.145;"><nobr>
<span style="font-size:20.022;">Only the bits corresponding to lower-privilege software interrupts (USIP, SSIP), timer interrupts</span>
</nobr></div>
<div style="position:absolute;top:832.589;left:132.145;"><nobr>
<span style="font-size:20.022;">(UTIP, STIP), and external interrupts (UEIP, SEIP) in mip are writable through this CSR address;</span>
</nobr></div>
<div style="position:absolute;top:857.456;left:132.145;"><nobr>
<span style="font-size:20.022;">the remaining bits are read-only.</span>
</nobr></div>
<div style="position:absolute;top:916.823;left:182.201;"><nobr>
<span style="font-size:18.285;font-style:italic;">The machine-level interrupt registers handle a few root interrupt sources which are assigned a</span>
</nobr></div>
<div style="position:absolute;top:938.767;left:182.201;"><nobr>
<span style="font-size:18.285;font-style:italic;">fixed service priority for simplicity, while separate external interrupt controllers can implement</span>
</nobr></div>
<div style="position:absolute;top:960.708;left:182.201;"><nobr>
<span style="font-size:18.285;font-style:italic;">a more complex prioritization scheme over a much larger set of interrupts that are then muxed</span>
</nobr></div>
<div style="position:absolute;top:982.650;left:182.201;"><nobr>
<span style="font-size:18.285;font-style:italic;">into the machine-level interrupt sources.</span>
</nobr></div>
<div style="position:absolute;top:1020.495;left:132.145;"><nobr>
<span style="font-size:20.022;">Restricted views of the mip and mie registers appear as the sip / sie , and uip / uie registers in</span>
</nobr></div>
<div style="position:absolute;top:1045.362;left:132.145;"><nobr>
<span style="font-size:20.022;">S-mode and U-mode respectively. If an interrupt is delegated to privilege mode</span>
<span style="font-size:20.022;font-style:italic;">x</span>
<span style="font-size:20.022;">by setting a bit in</span>
</nobr></div>
<div style="position:absolute;top:1070.229;left:132.145;"><nobr>
<span style="font-size:20.022;">the mideleg register, it becomes visible in the</span>
<span style="font-size:20.022;font-style:italic;">x</span>
<span style="font-size:20.022;">ip register and is maskable using the</span>
<span style="font-size:20.022;font-style:italic;">x</span>
<span style="font-size:20.022;">ie register.</span>
</nobr></div>
<div style="position:absolute;top:1095.097;left:132.145;"><nobr>
<span style="font-size:20.022;">Otherwise, the corresponding bits in</span>
<span style="font-size:20.022;font-style:italic;">x</span>
<span style="font-size:20.022;">ip and</span>
<span style="font-size:20.022;font-style:italic;">x</span>
<span style="font-size:20.022;">ie appear to be hardwired to zero.</span>
</nobr></div>
<div style="position:absolute;top:1139.502;left:147.313;"><nobr>
<span style="font-size:14.628;">MXLEN-1</span>
</nobr></div>
<div style="position:absolute;top:1139.502;left:244.998;"><nobr>
<span style="font-size:14.628;">12</span>
</nobr></div>
<div style="position:absolute;top:1139.502;left:290.066;"><nobr>
<span style="font-size:14.628;">11</span>
</nobr></div>
<div style="position:absolute;top:1139.502;left:355.395;"><nobr>
<span style="font-size:14.628;">10</span>
</nobr></div>
<div style="position:absolute;top:1139.502;left:421.572;"><nobr>
<span style="font-size:14.628;">9</span>
</nobr></div>
<div style="position:absolute;top:1139.502;left:477.084;"><nobr>
<span style="font-size:14.628;">8</span>
</nobr></div>
<div style="position:absolute;top:1139.502;left:536.006;"><nobr>
<span style="font-size:14.628;">7</span>
</nobr></div>
<div style="position:absolute;top:1139.502;left:601.700;"><nobr>
<span style="font-size:14.628;">6</span>
</nobr></div>
<div style="position:absolute;top:1139.502;left:664.336;"><nobr>
<span style="font-size:14.628;">5</span>
</nobr></div>
<div style="position:absolute;top:1139.502;left:720.552;"><nobr>
<span style="font-size:14.628;">4</span>
</nobr></div>
<div style="position:absolute;top:1139.502;left:778.420;"><nobr>
<span style="font-size:14.628;">3</span>
</nobr></div>
<div style="position:absolute;top:1139.502;left:842.695;"><nobr>
<span style="font-size:14.628;">2</span>
</nobr></div>
<div style="position:absolute;top:1139.502;left:903.927;"><nobr>
<span style="font-size:14.628;">1</span>
</nobr></div>
<div style="position:absolute;top:1139.502;left:957.334;"><nobr>
<span style="font-size:14.628;">0</span>
</nobr></div>
<div style="position:absolute;top:1159.079;left:173.472;"><nobr>
<span style="font-size:16.456;font-weight:bold;">WPRI</span>
</nobr></div>
<div style="position:absolute;top:1179.923;left:158.391;"><nobr>
<span style="font-size:16.456;">MXLEN-12</span>
</nobr></div>
<div style="position:absolute;top:1159.079;left:275.233;"><nobr>
<span style="font-size:16.456;">MEIP</span>
<span style="font-size:16.456;font-weight:bold;">WPRI</span>
<span style="font-size:16.456;">SEIP UEIP MTIP</span>
<span style="font-size:16.456;font-weight:bold;">WPRI</span>
<span style="font-size:16.456;">STIP UTIP MSIP</span>
<span style="font-size:16.456;font-weight:bold;">WPRI</span>
<span style="font-size:16.456;">SSIP USIP</span>
</nobr></div>
<div style="position:absolute;top:1179.923;left:293.614;"><nobr>
<span style="font-size:16.456;">1 1 1 1 1 1 1 1 1 1 1 1</span>
</nobr></div>
<div style="position:absolute;top:1227.339;left:322.216;"><nobr>
<span style="font-size:20.022;">Figure 3.11: Machine interrupt-pending register ( mip ).</span>
</nobr></div>
<div style="position:absolute;top:1274.899;left:132.145;"><nobr>
<span style="font-size:20.022;">The MTIP, STIP, UTIP bits correspond to timer interrupt-pending bits for machine, supervisor,</span>
</nobr></div>
<div style="position:absolute;top:1299.766;left:132.145;"><nobr>
<span style="font-size:20.022;">and user timer interrupts, respectively. The MTIP bit is read-only and is cleared by writing to the</span>
</nobr></div>
</td></tr>
</table>
